var url="assets/json/",allOrderList="",editList=!1,getJSON=function(e,t){var a=new XMLHttpRequest;a.open("GET",url+e,!0),a.responseType="json",a.onload=function(){var e=a.status;t(200===e?null:e,a.response)},a.send()};function loadOrderListData(e){$("#order-list").DataTable({data:e,bLengthChange:!1,order:[[1,"desc"]],language:{oPaginate:{sNext:'<i class="mdi mdi-chevron-right"></i>',sPrevious:'<i class="mdi mdi-chevron-left"></i>'}},columns:[{data:"id",render:function(e,t,a){return'<div class="form-check font-size-16">                        <input class="form-check-input" type="checkbox" id="orderlistIdCheck-'+a.id+'">                        <label class="form-check-label" for="orderlistIdCheck-'+a.id+'"></label>                    </div>'}},{data:null,render:function(e,t,a){return'<a href="javascript: void(0);" class="text-body orderlist-id fw-bold">#SK'+a.id+"</a>"}},{data:"billName",render:function(e,t,a){return'<div class="customerlist-name">'+a.billName+"</div>"}},{data:"date"},{data:"totalPay"},{data:"payStatus",render:function(e,t,a){return isStatus(a.payStatus)}},{data:"payMethod",render:function(e,t,a){return isMethod(a.payMethod)}},{data:null,bSortable:!1,render:function(e,t,a){return'<button type="button" class="btn btn-primary btn-sm btn-rounded viewdetail-btn" data-bs-toggle="modal" data-bs-target=".orderdetailsModal">View Details</button>'}},{data:null,bSortable:!1,render:function(e,t,a){return'<div class="d-flex gap-3">                    <a href="#newOrderModal" data-bs-toggle="modal" class="text-success edit-list" data-edit-id="'+a.id+'"><i class="mdi mdi-pencil font-size-18"></i></a>                    <a href="#removeItemModal" data-bs-toggle="modal" class="text-danger remove-list" data-remove-id="'+a.id+'"><i class="mdi mdi-delete font-size-18"></i></a>                </div>'}}],drawCallback:function(e){editOrderList(),removeItem(),orderDetailShow()}}),$("#searchTableList").keyup((function(){$("#order-list").DataTable().search($(this).val()).draw()})),$(".dataTables_length select").addClass("form-select form-select-sm"),$(".dataTables_paginate").addClass("pagination-rounded"),$(".dataTables_filter").hide()}function isStatus(e){switch(e){case"Paid":return'<span class="badge rounded-pill badge-soft-success font-size-12">'+e+"</span>";case"Refund":return'<span class="badge rounded-pill badge-soft-warning font-size-12">'+e+"</span>";case"Chargeback":return'<span class="badge rounded-pill badge-soft-danger font-size-12">'+e+"</span>"}}function isMethod(e){switch(e){case"Mastercard":return'<div><i class="fab fa-cc-mastercard me-1"></i>'+e+"</div>";case"Visa":return'<div><i class="fab fa-cc-visa me-1"></i>'+e+"</div>";case"Paypal":return'<div><i class="fab fa-cc-paypal me-1"></i>'+e+"</div>";case"COD":return'<div><i class="fas fa-money-bill-alt me-1"></i>'+e+"</div>"}}getJSON("ecommerce-order-list.json",(function(e,t){null!==e?console.log("Something went wrong: "+e):loadOrderListData(allOrderList=t)}));var date=new Date,today=new Date(date.getFullYear(),date.getMonth(),date.getDate());$("#orderdate-input").datepicker("setDate",today);var createOrderForms=document.querySelectorAll(".createorder-form");function fetchIdFromObj(e){return parseInt(e.id)}function findNextId(){if(0===allOrderList.length)return 0;var e=fetchIdFromObj(allOrderList[allOrderList.length-1]),t=fetchIdFromObj(allOrderList[0]);return t>=e?t+1:e+1}function editOrderList(){var e=0;Array.from(document.querySelectorAll(".edit-list")).forEach((function(t){t.addEventListener("click",(function(a){e=t.getAttribute("data-edit-id"),editList=!0,document.getElementById("createorder-form").classList.remove("was-validated"),allOrderList=allOrderList.map((function(t){return t.id==e&&(document.getElementById("newOrderModalLabel").innerHTML="Edit Order",document.getElementById("addNewOrder-btn").innerHTML="Save",document.getElementById("orderid-input").value=t.id,document.getElementById("customername-field").value=t.billName,$("#orderdate-input").datepicker("setDate",t.date),document.getElementById("payamount-input").value=t.totalPay,document.getElementById("paystatus-input").value=t.payStatus,document.getElementById("paymethod-input").value=t.payMethod),t}))}))}))}function removeItem(){var e=0;Array.from(document.querySelectorAll(".remove-list")).forEach((function(t){t.addEventListener("click",(function(a){e=t.getAttribute("data-remove-id"),document.getElementById("remove-item").addEventListener("click",(function(){var t,a=(t=e,allOrderList.filter((function(e){return e.id!=t})));allOrderList=a,$.fn.DataTable.isDataTable("#order-list")&&$("#order-list").DataTable().destroy(),loadOrderListData(allOrderList),document.getElementById("close-removeOrderModal").click()}))}))}))}function orderDetailShow(){Array.from(document.querySelectorAll("#order-list tbody tr")).forEach((function(e){e.querySelector(".viewdetail-btn").addEventListener("click",(function(){var t=e.querySelector(".orderlist-id").innerHTML,a=e.querySelector(".customerlist-name").innerHTML;document.querySelector("#orderlist-overview .list-id").innerHTML=t,document.querySelector("#orderlist-overview .orderlist-customer").innerHTML=a}))}))}Array.prototype.slice.call(createOrderForms).forEach((function(e){e.addEventListener("submit",(function(t){if(e.checkValidity()){t.preventDefault();var a=document.getElementById("customername-field").value,r=document.getElementById("orderdate-input").value,d=document.getElementById("payamount-input").value,n=document.getElementById("paystatus-input").value,i=document.getElementById("paymethod-input").value;if(""===a||""===r||""===d||""===n||""===i||editList){if(""!==a&&""!==r&&""!==d&&""!==n&&""!==i&&editList){var l;l=document.getElementById("orderid-input").value,allOrderList=allOrderList.map((function(e){return e.id==l?{id:l,billName:a,date:r,totalPay:d,payStatus:n,payMethod:i}:e})),editList=!1}}else{var o={id:findNextId(),billName:a,date:r,totalPay:d,payStatus:n,payMethod:i};allOrderList.push(o)}$.fn.DataTable.isDataTable("#order-list")&&$("#order-list").DataTable().destroy(),loadOrderListData(allOrderList),$("#newOrderModal").modal("hide")}else t.preventDefault(),t.stopPropagation();e.classList.add("was-validated")}),!1)})),Array.from(document.querySelectorAll(".addOrder-modal")).forEach((function(e){e.addEventListener("click",(function(e){editList=!1,document.getElementById("createorder-form").classList.remove("was-validated"),document.getElementById("newOrderModalLabel").innerHTML="Add New Order",document.getElementById("addNewOrder-btn").innerHTML="Create",document.getElementById("orderid-input").value="",document.getElementById("customername-field").value="",$("#orderdate-input").datepicker("setDate",today),document.getElementById("payamount-input").value="",document.getElementById("paystatus-input").value="Paid",document.getElementById("paymethod-input").value="Mastercard"}))}));