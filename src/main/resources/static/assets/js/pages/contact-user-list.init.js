var url="assets/json/",userListData="",editList=!1,getJSON=function(e,t){var a=new XMLHttpRequest;a.open("GET",url+e,!0),a.responseType="json",a.onload=function(){var e=a.status;t(200===e?null:e,a.response)},a.send()};function loadUserList(e){$("#userList-table").DataTable({data:e,bLengthChange:!1,order:[[0,"desc"]],language:{oPaginate:{sNext:'<i class="mdi mdi-chevron-right"></i>',sPrevious:'<i class="mdi mdi-chevron-left"></i>'}},columns:[{data:null,render:function(e,t,a){var i=a.memberImg?'<img src="'+a.memberImg+'" alt="" class="member-img img-fluid d-block rounded-circle" />':'<div class="avatar-title rounded-circle text-uppercase">'+a.nickname+"</div>";return'<div class="d-none">'+a.id+'</div><div class="avatar-xs img-fluid rounded-circle">'+i+"</div"}},{data:null,render:function(e,t,a){return'<div>                    <h5 class="text-truncate font-size-14 mb-1"><a href="javascript: void(0);" class="text-dark">'+a.userName+'</a></h5>                    <p class="text-muted mb-0">'+a.designation+"</p>                    </div>"}},{data:"email"},{data:"tags",render:function(e,t,a){var i=a.tags,n="";if(Array.from(i.slice(0,2)).forEach((function(e,t){n+='<a href="javascript: void(0);" class="badge badge-soft-primary font-size-11 m-1">'+e+"</a>"})),i.length>2){var s=i.length-2;n+='<a href="javascript: void(0);" class="badge badge-soft-primary font-size-11 m-1">'+s+" more</a>"}return n}},{data:"projects"},{data:null,bSortable:!1,render:function(e,t,a){return'<ul class="list-inline font-size-20 contact-links mb-0">                    <li class="list-inline-item">                        <a href="javascript: void(0);" class="px-2"><i class="bx bx-message-square-dots"></i></a>                    </li>                    <li class="list-inline-item">                        <a href="javascript: void(0);" class="px-2"><i class="bx bx-user-circle"></i></a>                    </li>                    <li class="list-inline-item">                    <div class="dropdown">                        <a href="javascript: void(0);" class="dropdown-toggle card-drop px-2" data-bs-toggle="dropdown" aria-expanded="false">                            <i class="mdi mdi-dots-horizontal font-size-18"></i>                        </a>                        <ul class="dropdown-menu dropdown-menu-end">                            <li><a href="#newContactModal" data-bs-toggle="modal" class="dropdown-item edit-list" data-edit-id="'+a.id+'"><i class="mdi mdi-pencil font-size-16 text-success me-1"></i> Edit</a></li>                            <li><a href="#removeItemModal" data-bs-toggle="modal" class="dropdown-item remove-list" data-remove-id="'+a.id+'"><i class="mdi mdi-trash-can font-size-16 text-danger me-1"></i> Delete</a></li>                        </ul>                    </div>                    </li>                </ul>'}}],drawCallback:function(e){editContactList(),removeItem()}}),$("#searchTableList").keyup((function(){$("#userList-table").DataTable().search($(this).val()).draw()})),$(".dataTables_length select").addClass("form-select form-select-sm"),$(".dataTables_paginate").addClass("pagination-rounded"),$(".dataTables_filter").hide()}getJSON("contact-user-list.json",(function(e,t){null!==e?console.log("Something went wrong: "+e):loadUserList(userListData=t)})),$("#tag-input").select2();var createContactForms=document.querySelectorAll(".createContact-form");function fetchIdFromObj(e){return parseInt(e.id)}function findNextId(){if(0===userListData.length)return 0;var e=fetchIdFromObj(userListData[userListData.length-1]),t=fetchIdFromObj(userListData[0]);return t>=e?t+1:e+1}function editContactList(){var e=0;Array.from(document.querySelectorAll(".edit-list")).forEach((function(t){t.addEventListener("click",(function(a){e=t.getAttribute("data-edit-id"),editList=!0,document.getElementById("createContact-form").classList.remove("was-validated"),userListData=userListData.map((function(t){return t.id==e&&(document.getElementById("newContactModalLabel").innerHTML="Edit Profile",document.getElementById("addContact-btn").innerHTML="Update",document.getElementById("userid-input").value=t.id,""==t.memberImg?document.getElementById("member-img").src="assets/images/users/user-dummy-img.jpg":document.getElementById("member-img").src=t.memberImg,document.getElementById("username-input").value=t.userName,document.getElementById("designation-input").value=t.designation,document.getElementById("email-input").value=t.email,$("#tag-input").select2({multiple:!0}),$("#tag-input").val(t.tags).trigger("change")),t}))}))}))}function removeItem(){var e=0;Array.from(document.querySelectorAll(".remove-list")).forEach((function(t){t.addEventListener("click",(function(a){e=t.getAttribute("data-remove-id"),document.getElementById("remove-item").addEventListener("click",(function(){var t,a=(t=e,userListData.filter((function(e){return e.id!=t})));userListData=a,$.fn.DataTable.isDataTable("#userList-table")&&$("#userList-table").DataTable().destroy(),loadUserList(userListData),$("#removeItemModal").modal("hide")}))}))}))}Array.prototype.slice.call(createContactForms).forEach((function(e){e.addEventListener("submit",(function(t){if(e.checkValidity()){t.preventDefault();var a,i=document.getElementById("member-img").src,n=i.substring(i.indexOf("/as")+1);a="assets/images/users/user-dummy-img.jpg"==n?"":i;var s=document.getElementById("username-input").value,r=s.match(/\b(\w)/g).join("").substring(0,2),d=document.getElementById("designation-input").value,l=document.getElementById("email-input").value,o=$("#tag-input").val();if(""===s||""===d||""===l||editList){if(""!==s&&""!==d&&""!==l&&editList){var m;m=document.getElementById("userid-input").value,userListData=userListData.map((function(e){return e.id==m?{id:m,memberImg:a,nickname:r,userName:s,designation:d,email:l,tags:o,projects:e.projects}:e})),editList=!1}}else{var c={id:findNextId(),memberImg:a,nickname:r,userName:s,designation:d,email:l,tags:o,projects:"--"};userListData.push(c)}$.fn.DataTable.isDataTable("#userList-table")&&$("#userList-table").DataTable().destroy(),loadUserList(userListData),$("#newContactModal").modal("hide")}else t.preventDefault(),t.stopPropagation();e.classList.add("was-validated")}),!1)})),document.querySelector("#member-image-input").addEventListener("change",(function(){var e=document.querySelector("#member-img"),t=document.querySelector("#member-image-input").files[0],a=new FileReader;a.addEventListener("load",(function(){e.src=a.result}),!1),t&&a.readAsDataURL(t)})),Array.from(document.querySelectorAll(".addContact-modal")).forEach((function(e){e.addEventListener("click",(function(e){editList=!1,document.getElementById("createContact-form").classList.remove("was-validated"),document.getElementById("newContactModalLabel").innerHTML="Add Contact",document.getElementById("addContact-btn").innerHTML="add",document.getElementById("userid-input").value="",document.getElementById("username-input").value="",document.getElementById("email-input").value="",document.getElementById("designation-input").value="",document.getElementById("member-img").src="assets/images/users/user-dummy-img.jpg",$("#tag-input").select2({multiple:!0}),$("#tag-input").val("").trigger("change")}))}));