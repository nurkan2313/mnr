<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<section layout:fragment="content">

    <div class="row">

        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a th:href="@{/dashboard}">Дэшборд</a></li>
                <li class="breadcrumb-item active" aria-current="page">Разрешения</li>
            </ol>
        </nav>

        <h2 class="mb-3">Разрешения CITES, выданные за период с 2020 г. по сегодняшний день</h2>

        <form class="row mb-4" method="get" th:action="@{/permission/list}">
            <div class="col-md-3">
                <input type="text" name="permitNumber" class="form-control" placeholder="Номер разрешения" th:value="${param.permitNumber}">
            </div>
            <div class="col-md-3">
                <input type="text" name="companyName" class="form-control" placeholder="Организация" th:value="${param.companyName}">
            </div>
            <div class="col-md-3">
                <input type="text" name="object" class="form-control" placeholder="Объект" th:value="${param.object}">
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">Фильтровать</button>
            </div>
        </form>

        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Добавить новое разрешение</h4>
                <div class="row">
                    <div class="d-flex flex-wrap gap-2">
                        <a class="btn btn-success waves-effect btn-label waves-light w-100" th:href="@{/permission}">
                            <i class="bx bx-check-double label-icon"></i> добавить
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <table class="table table-striped">
            <thead>
            <tr>
                <th>Номер</th>
                <th>Организация</th>
                <th>Объект</th>
                <th>Кол-во</th>
                <th>Тип</th>
                <th>Статус</th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="permit : ${permits}">
                <td th:text="${permit.id}"></td>
                <td th:text="${permit.companyName}"></td>
                <td th:text="${permit.object}"></td>
                <td th:text="${permit.quantity}"></td>
                <td th:text="${permit.type}"></td>
                <td th:text="${permit.statusDescription}" class="text-capitalize"></td>
                <td>
                    <a th:href="@{'/permission/' + ${permit.id}}" class="btn btn-sm btn-outline-primary">Просмотр</a>
                </td>
            </tr>
            </tbody>
        </table>

        <nav th:if="${totalPages > 1}" aria-label="Pagination">
            <ul class="pagination">
                <li class="page-item" th:classappend="${previousDisabled} ? 'disabled'">
                    <a class="page-link" th:href="@{|/permission/list?page=${previousPage}|}">Назад</a>
                </li>
                <li class="page-item" th:each="pageNum : ${pageNumbers}" th:classappend="${pageNum == currentPage} ? 'active'">
                    <a class="page-link" th:text="${pageNum}" th:href="@{|/permission/list?page=${pageNum}|}"></a>
                </li>
                <li class="page-item" th:classappend="${nextDisabled} ? 'disabled'">
                    <a class="page-link" th:href="@{|/permission/list?page=${nextPage}|}">Вперёд</a>
                </li>
            </ul>
        </nav>

    </div>

</section>
</html>